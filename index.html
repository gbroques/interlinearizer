<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interlinearizer</title>
    <style>
    @media print {
      .no-print { display: none; }
    }
    #container {
      text-align: justify;
    }
    .pair {
      display: inline-block;
      padding: 0;
      margin: 0;
      padding-left: 1.4vw;
      margin-top: 2vw;
      font-family: inherit;
      white-space: nowrap;
      text-align: center;
      cursor: default;
      line-height: 1.2;
      vertical-align: top;
    }
    .original {
      display: inline-block;
      margin-bottom: 0;
      padding-bottom: 0;
      color: #222222;
      min-width: 5px;
      font-weight: inherit;
      font-size: 1.2em;
    }
    .translation {
      font-size: 0.74em;
      color: #6E6B6B;
      margin-top: 0.74vw;
      margin-bottom: 0;
      padding-bottom: 0;
      display: block;
    }
    </style>
</head>
<body>
    <div class='no-print'>
      <h1>Interlinearizer</h1>
      <p>Generates an <a target="_blank" href="https://en.wikipedia.org/wiki/Interlinear_gloss"><em>interlinear text</em></a> — a text with translation between lines — given translation pairs of semantic units (the shortest possible part of a phrase which makes sense when translated).</p>
      <p>Translations are separated by a tab, pairs by a newline <code>\n</code>, and paragraphs by pipes <code>|</code>.<p>
      <p>For example:</p>
      <pre>
Un 	An
ejemplo.	example.
|	|
¡Pruebalo!	Try it!</pre>
      <p>Results may be saved as a PDF by pressing <code>Ctrl</code> + <code>P</code>.</p>
      <p>Inspired from <a target="_blank" href="https://interlinearbooks.com/">Interlinear Books</a> and their <a href="https://interlinearbooks.com/tools/interlinearizer/">interlinearizer tool</a>.</p>
      <form onsubmit="handleSubmit(event)">
  <textarea rows="10" cols="70" name="text" id="text" placeholder="Un 	An
ejemplo.	example.
|	|
¡Pruebalo!	Try it!"></textarea>
        <button type="submit">Submit</button>
      </form>
    </div>
    <div id="container"></div>
    <script>
      function parseTextIntoPairs(text) {
        const lines = text.split('\n');
        return lines.map(line => line.split(/\t/));
      }
      function createSpan(className, innerText = '') {
        const span = document.createElement('span');
        span.className = className;
        span.innerText = innerText;
        return span;
      }
      function* pairsIntoParagraphs(pairs) {
        if (!pairs || !pairs.length) return;
        let paragraph = document.createElement('p');
        for (const [original, translation] of pairs) {
          if (!original || !translation) {
            yield paragraph;
            return;
          }
          if (original === '|' || translation === '|') {
            yield paragraph;
            paragraph = document.createElement('p');
          } else {
            const pairContainer = createSpan('pair');
            const span1 = createSpan('original', original);
            pairContainer.appendChild(span1);
            pairContainer.appendChild(document.createElement('br'));
            const span2 = createSpan('translation', translation);
            pairContainer.appendChild(span2);
            paragraph.appendChild(pairContainer);
          }
        }
        yield paragraph;
      }
      function interlinearize(text) {
        const container = document.getElementById('container');
        container.innerHTML = '';
        if (!text) return;
        const pairs = parseTextIntoPairs(text);
        for (const paragraph of pairsIntoParagraphs(pairs)) {
          container.appendChild(paragraph);
        }
      }
      function handleSubmit(event) {
        event.preventDefault();
        const text = event.target.text.value;
        interlinearize(text);
      }
    </script>
</body>
</html>
